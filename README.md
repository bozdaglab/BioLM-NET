# **BioLM-NET**  
## BioLM-NET: An interpretable deep-learning model combining prior biological knowledge and contextual LLM gene embeddings on multi-omics data to predict disease.


## Overview
Biologically informed deep neural networks which connect input features to hidden layers based on known gene–pathway relationships have become increasingly popular. However, existing approaches often omit key molecular interactions such as Protein–Protein Interactions (PPI) and Protein–DNA Interactions (PDI).

Contribution of **BioLM-NET** :
- Fusing single-cell or bulk gene expression data with DNA methylation profiles
- Integrating PPI and PDI networks directly into the model architecture
- Aggregating omics signals at the pathway level via an attention-based pathway layer
- Incorporating contextual gene embeddings generated by a pre-trained large language model (LLM)

##  Model Architecture
<p align="center">
  <img 
    src="images/BioLM-NET Final Architecture.png" 
    alt="BioLM-NET final architecture" 
    width="800" 
  >
</p>

1. **Omics branches**  
   - **Gene expression** and **DNA methylation** processed through separate masked-dense layers informed by PPI/PDI  
2. **Pathway Attention Layer**  
   - Projects gene and methylation branch embeddings to pathway representations  
   - Applies attention weights guided by LLM-derived gene embeddings  
3. **Fusion & Prediction**  
   - Concatenates pathway-level representations  
   - Passes through dense fusion layers to output disease-state probabilities
## Install Dependencies

```bash
pip install -r requirements.txt
```

## How to Run the Code

1. **The five CSV files for the chosen dataset must be loaded.**  
   1. For **scTrioseq2**, for example:  
      ```python
      df_gene = pd.read_csv("Dataset/scTrioseq2/Gene_Expression.csv")
      df_dna = pd.read_csv("Dataset/scTrioseq2/DNA_Methylation.csv")
      true_label = pd.read_csv("Dataset/scTrioseq2/label.csv")
      ge_target_to_kegg = pd.read_csv("Dataset/scTrioseq2/ge_target_to_KEGG_significant.csv")
      dna_target_to_kegg = pd.read_csv("Dataset/scTrioseq2/dna_target_to_KEGG_significant.csv")
      ```
2. **PDI data should be loaded:**  
   ```python
   df_pdi = pd.read_csv("Dataset/PDI/PDI.csv")
   ```
3. **PPI data should be loaded:**  
   ```python
   df_ppi = pd.read_csv("Dataset/PPI/PPI.csv")
   ```
4. **LLM embeddings should be loaded into the variable `FNAME`:**  
   - **Single-cell data (scTrioseq2):** one of the following filenames is to be selected from [GenePT Composable Embeddings](https://huggingface.co/honicky/genept-composable-embeddings):  
     ```text
     embedding_associations_age_cell_type_drugs_pathways_openai_large.parquet
     embedding_associations_age_drugs_pathways_openai_large.parquet
     embedding_associations_cell_type_openai_large.parquet
     embedding_associations_cell_type_tissue_drug_pathway_openai_large.parquet
     ```  
     Then assigned, for example:  
     ```python
     FNAME = "embedding_associations_age_cell_type_drugs_pathways_openai_large.parquet"
     ```
   - **Bulk data (BRCA, COAD, GBM):** one of the following filenames is to be selected:  
     ```text
     embedding_original_ada_text.parquet
     embedding_original_large_3.parquet
     ```  
     Then assigned, for example:  
     ```python
     FNAME = "embedding_original_large_3.parquet"
     ```
5. **A new dataset must be formatted as follows:**  
   1. **Gene expression / DNA methylation:**  
      - Samples are represented by rows, and gene names by columns.  
   2. **PDI:** two columns (`TF`, `Target`) are required:  
      ```csv
      TF,Target
      ```  
   3. **PPI:** three columns (`protein1`, `protein2`, `combined_score`) are required:  
      ```csv
      protein1,protein2,combined_score
      ```  
   4. **Pathways:** two columns (`SYMBOL`, `PathwayID`) are required:  
      ```csv
      SYMBOL,PathwayID
      ```  

## Notebooks

- **BioLMNET.ipynb**  
  This notebook contains the core implementation of the BioLM‑NET model. This notebook:  
  1. Loads and preprocesses multi-omics datasets (gene expression, DNA methylation, PDI, PPI, and pathway data).  
  2. Builds the BioLM‑NET architecture with attention-based pathway layers and LLM derived gene embeddings.  
  3. Trains the model, evaluates performance (accuracy, F1, precision, recall) 

- **BioLMNET_Weighted_Loss.ipynb**  
  A variant of the main notebook that demonstrates how to incorporate a weighted loss function to address class imbalance. It includes:  
  1. Calculation of class weights based on label distribution.  
  2. Modifications to the training loop to apply the weighted loss. 
